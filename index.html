<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>Baikal</title>

  <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@6.1.1/dist/aframe-extras.min.js"></script>
  
  <script src="lib/RGBELoader.js"></script>
  <script src="lib/path-walker.js"></script>
  <script src="lib/reset-on-collision.js"></script>

  <script src="components/aframe-orbit-controls.js"></script>
  <script src="components/aframe-env-map-component.js"></script>
  <script src="components/aframe-hdr-environment.js"></script>

  <style>
    body { margin: 0; }
    .hint { position: absolute; top: 8px; left: 8px; padding: 6px 10px; background: rgba(0,0,0,0.5); color:#fff; font-size:13px; border-radius:4px;}
  </style>
</head>
<body>
  <div class="hint">WASD + мышь для управления. Ctrl+Alt+I — инспектор.</div>
  
  <a-scene light="defaultLightsEnabled: false" hdr-environment="url: assets/skybox2.hdr; showBackground: true; showGround: true; groundSize: 1500">
    <a-assets> 
      <!-- <asset-item id="tree" src="assets/low_poly_tree_wind.glb"></asset-item> -->
      <asset-item id="rabbit" src="assets/low_poly_rabbit.glb"></asset-item>
      <asset-item id="deer" src="assets/low_poly_deer.glb"></asset-item>
      <!-- <asset-item id="rock1" src="assets/rock2.glb"></asset-item> -->
    </a-assets>
    <!-- 3D models -->
    <!-- <a-entity id="treeModel0" gltf-model="#tree" animation-mixer="loop: repeat" scale="0.04 0.05 0.015" position="-19.35115 0.5 -35.61047"> -->
      <!-- Вместо кривого куба коллизии модели кастомный куб -->
      <!-- <a-box id="collisionBoxTree0" scale="1.5 1.5 1.5" position="0 38 0" depth="50" height="75" width="20" visible="false" class="collision"></a-box> 
    </a-entity> -->
    <!-- <a-entity id="treeModel1" gltf-model="#tree" animation-mixer="loop: repeat" scale="0.04 0.05 0.015" position="-14.76294 0.5 -19.88712">
      <a-box id="collisionBoxTree1" scale="1.5 1.5 1.5" position="0 38 0" depth="50" height="75" width="20" visible="false" class="collision"></a-box> 
    </a-entity> -->
    <!-- <a-entity id="treeModel2" gltf-model="#tree" animation-mixer="loop: repeat" scale="0.04 0.05 0.015" position="22.34124 0.5 -28.73714">
      <a-box id="collisionBoxTree2" scale="1.5 1.5 1.5" position="0 38 0" depth="50" height="75" width="20" visible="false" class="collision"></a-box> 
    </a-entity> -->
    
    <!-- <a-entity id="rockModel1" gltf-model="#rock1"visible="false" class="collision"></a-entity> -->
    <a-entity id="rabbitModel" gltf-model="#rabbit" scale="0.3 0.3 0.3" class="collision"
              path-walker="
              clip: Armature.001|Run;
              idleClip: Armature.001|Idle;
              path: [[5,0.5,-15],[11,0.5,-15],[11,0.5,-9],[5,0.5,-9],[5,0.5,-15]];
              speed: 2.5;
              restTime: 6;"></a-entity>
    <a-entity id="deerModel" gltf-model="#deer" scale="1 1 1" class="collision"
              path-walker="
              clip: Armature|Walk;
              idleClip: Armature|Eat;
              path: [[0,0.5,0],[3,0.5,0],[3,0.5,3],[0,0.5,0]];
              speed: 1.5;
              restTime: 10;"></a-entity>
    
    <!-- Поверхности -->
    <a-plane id="lakeSurface" geometry="primitive: box; depth: 60; height: 1; width: 90" width="60" height="60"
             material="color: #9cc6ec; roughness: 0.7; metalness: 1; opacity: 0.6; transparent: true; depthTest: true; side: double"
             position="0 0 50"></a-plane>
    <a-plane id="groundSurface" scale="1 1 1" geometry="primitive: box; depth: 90; height: 2; width: 90" width="60" height="60"
             material="color: #e1d1c7; roughness: 0.8; metalness: 0.2; opacity: 1; transparent: true; fog: false"
             position="0 -0.5 -25"></a-plane>

    <!-- Анимированный туман в горах -->
    <a-plane id="fogSurface0" scale="10 5 10" geometry="primitive: sphere; segmentsWidth: 6; segmentsHeight: 6" width="60" height="60"
             material="color: #b8d7ff; roughness: 0.8; metalness: 0.2; opacity: 0.5; transparent: true"
             path-walker="
             path: [[-10.5,7,-37],[-10.5,7.5,-37],[-10.5,7,-37]];
             speed: 0.15;
             restTime: 0;
             lookAt: false; 
              "></a-plane>
    <a-plane id="fogSurface1" scale="15 5 10" geometry="primitive: sphere; segmentsWidth: 6; segmentsHeight: 6" width="60" height="60"
             material="color: #b8d7ff; roughness: 0.8; metalness: 0.2; opacity: 0.5; transparent: true"
             path-walker="
             path: [[-3.5,18,-44.5],[-3.5,17,-44.5],[-3.5,18,-44.5]];
             speed: 0.2;
             restTime: 0;
             lookAt: false;             
              "></a-plane> 
    <a-plane id="fogSurface2" scale="12 5 12" geometry="primitive: sphere; segmentsWidth: 6; segmentsHeight: 6" width="60" height="60"
             material="color: #b8d7ff; roughness: 0.8; metalness: 0.2; opacity: 0.5; transparent: true"             
             path-walker="
             path: [[10.5,8,-36.5],[10.5,8.5,-36.5],[10.5,8,-36.5]];
             speed: 0.15;
             restTime: 0;
             lookAt: false;
              "></a-plane>

    
    <a-plane id="fogWater" visible="true" scale="1 5 1" geometry="primitive: box; segmentsWidth: 6; depth: 60; height: 1; width: 90" width="60" height="60"
             material="color: #b8d7ff; roughness: 0.8; metalness: 0.2; opacity: 0.5; transparent: true; visible: true; side: double; depthTest: true; depthWrite: true; fog: true; flatShading: false"
             position="0 3.5 67.93505"></a-plane>
    <a-plane id="water" scale="1 5 1" geometry="primitive: box; segmentsWidth: 6; depth: 60; height: 1" width="60" height="60"
             material="color: #6babff; roughness: 0.8; metalness: 0.2; opacity: 1; transparent: false; visible: true; alphaTest: 0; fog: true; side: double"
             position="0 -3 50"></a-plane>                                                                     

    <!-- Скалы -->
    <a-box id="rock0" geometry="height: 20; width: 10; depth: 8" material="color: #7c756e" position="-1.54505 7.7486 -43.4083" depth="2" width="10" height="4" color="#8B7D7B" class="collision">
      <a-box id="lilrock0" geometry="width: 10; height: 15; depth: 7" material="color: #7c756e" position="-7.20579 -2.11174 2.90727" depth="2" width="10" height="4" color="#8B7D7B" class="collision"></a-box>
      <a-box id="lilrock1" geometry="depth: 5; height: 10; width: 7" position="0.55012 13.8052 -0.68011" material="color: #7c756e"></a-box>
      <a-box id="lilrock2" geometry="depth: 6; height: 15; width: 8" position="7.37006 -0.02435 -0.14172" material="color: #7c756e"></a-box>
      <a-box id="lilrock3" geometry="height: 12" material="color: #7c756e" position="6.7837 -1.1688 4.48303" depth="3" width="5" height="6" class="collision"></a-box>
      <a-box id="lilrock4" geometry="width: 8; height: 15; depth: 6" material="color: #7c756e" position="0.23492 -1.90914 7.66073" depth="2" width="4" height="3" color="#6e6e6e" class="collision"></a-box>
    </a-box>

    <a-cone id="rock1" geometry="radiusBottom: 10; segmentsHeight: 18; height: 30; segmentsRadial: 4" geometry= "segmentsRadial: 4" scale="1 1 0.5" material="color: #7c756e; flatShading: true" position="-12 14 -55" depth="2" width="4" height="3" color="#6e6e6e" class="collision"></a-cone>
    <a-cone id="rock2" geometry="radiusBottom: 10; segmentsHeight: 18; height: 21; segmentsRadial: 4" geometry= "segmentsRadial: 4" scale="1 1 0.7" material="color: #7c756e; flatShading: true" position="13.67606 10.81715 -52.3457" depth="2" width="4" height="3" color="#6e6e6e" class="collision"></a-cone>

    <!-- Типа чаща из далека -->
    <a-box id="miniWood1" geometry="width: 16; height: 2; depth: 16" material="color: #4c5a3a" position="40.97814 0.20594 -65.85827" depth="2" width="4" height="3" color="#6e6e6e" class="collision"></a-box>
    <a-box id="miniWood2" geometry="width: 16; height: 3; depth: 12" material="color: #4c5a3a" position="-37.19538 -0.12635 -63.40628" depth="2" width="4" height="3" color="#6e6e6e" class="collision"></a-box>
    <a-plane id="bigWood1" position="46 4.5 -15" scale="15 5 40" geometry="primitive: sphere; segmentsWidth: 6; segmentsHeight: 6" width="60" height="60" material="color: #5c7a65; roughness: 0.8; metalness: 0.2"></a-plane>
    <a-plane id="bigWood2" position="-46 4.5 -15" scale="15 5 40" geometry="primitive: sphere; segmentsWidth: 6; segmentsHeight: 6" width="60" height="60" material="color: #5c7a65; roughness: 0.8; metalness: 0.2; visible: true"></a-plane>
    
    <!-- Деревья -->
    <a-cylinder id="treeTrunk1" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="-8.76446 1 -24.09229" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves1" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk2" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="-6.04191 1 -20.15475" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves2" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk3" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="4.17304 1 -21.35939" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves3" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk4" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="9.71894 1 -22.3125" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves4" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk5" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="6.87173 1 -18.40522" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves5" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk6" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="-8.76446 1 -17.61712" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves6" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk7" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="-6.04191 1 -15.65432" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves7" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk8" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="4.17304 1 -13.5815" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves8" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk9" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="9.71894 1 -17.53389" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves9" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk10" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="6.87173 1 -12.58104" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves10" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk11" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="-8.76446 1 -11.43092" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves11" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk12" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="-6.04191 1 -10.81331" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves12" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk13" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="4.17304 1 -9.38189" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves13" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk14" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="9.71894 1 -13.51645" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves14" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk15" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="6.87173 1 -7.46494" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves15" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk16" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="-8.76446 1 -6.87187" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves16" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk17" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="-6.04191 1 -5.96113" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves17" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk18" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="4.17304 1 -4.1135" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves18" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk19" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="9.71894 1 -5.82688" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves19" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <a-cylinder id="treeTrunk20" material="color: #4e443b; roughness: 0.85" geometry="segmentsRadial: 3" position="6.87173 1 -1.94234" radius="0.2" height="2" color="#5a381e" class="collision">
      <a-cone id="treeLeaves20" material="color: #466755; roughness: 0.85" scale="1 1 1" geometry="segmentsWidth: 3; segmentsRadial: 3; height: 5" position="0 3.5 0" radius="1" color="#2e8b57"></a-cone>
    </a-cylinder>
    <!-- Кубы коллизии/границы -->
     <a-box id="cllsnCube0" geometry="height: 5; width: 1; depth: 100" position="30 3 7.66307" depth="2" width="10" height="4" visible="false" class="collision"></a-box>
     <a-box id="cllsnCube1" geometry="height: 5; width: 30; depth: 1" position="16.21193 3 -38.47529" depth="2" width="10" height="4" visible="false" class="collision"></a-box>
     <a-box id="cllsnCube2" geometry="height: 5; width: 17; depth: 1" position="-21.9739 3 -43.09944" depth="2" width="10" height="4" visible="false" class="collision"></a-box>
     <a-box id="cllsnCube3" geometry="height: 5; width: 1; depth: 105" position="-30 3 6.05835" depth="2" width="10" height="4" visible="false" class="collision"></a-box>
     <a-box id="cllsnCube4" geometry="height: 5; width: 60; depth: 1" position="0 3 58.07577" depth="2" width="10" height="4" visible="false" class="collision"></a-box>

     <!-- <a-box id="cllsnCube5" geometry="height: 5; width: 10; depth: 8" position="-1.54505 17.31806 -27.86194" depth="2" width="10" height="4" visible="false" class="collision"></a-box>
     <a-box id="cllsnCube6" geometry="height: 5; width: 10; depth: 8" position="-1.54505 18.45354 -14.39617" depth="2" width="10" height="4" visible="false" class="collision"></a-box>
     <a-box id="cllsnCube7" geometry="height: 5; width: 10; depth: 8" position="-1.54505 19.92326 -1.86539" depth="2" width="10" height="4" visible="false" class="collision"></a-box> -->
    <!-- Камера -->
    <a-entity id="rig" position="0 1.7 0">
      <a-entity id="playerCam"
            camera
            look-controls
            wasd-controls
            geometry="primitive: box; width: 1; height: 1; depth: 1; visible: false"
            reset-on-collision="with: .collision; colliderSize: 0.6; smoothRecovery: true">
        <a-entity id="cursor"
              cursor="rayOrigin: mouse"
              position="0 0 -1"
              geometry="primitive: ring; radiusInner: 0.005; radiusOuter: 0.01"
              material="shader: flat; color: #fff">
        </a-entity>
      </a-entity>
    </a-entity>

  </a-scene>
</body>
</html>
